# Repos-Manager 要件定義書

## 概要

本Repositoryは[Project Manager](https://marketplace.visualstudio.com/items?itemName=alefragnani.project-manager)の課題を解決し、より使いやすいGitリポジトリ管理を提供するRepos-Managerという新たなVS Code拡張機能開発のためのリポジトリです。

### Project Managerの課題

- タグは手動設定が必要で、リポジトリが増えると管理が困難
- 検索・フィルタリング機能が限定的
- リポジトリの状態や活動状況が一目で分からない

## 機能要件

### 1. リポジトリ検知・分析機能

以下の項目を検知・分析します（手動更新）：

#### 基本情報

1. **主体言語** - ファイル拡張子とコード量から判定
2. **Runtime環境** - package.json、requirements.txt等から検出
3. **データベース種類** - 設定ファイルや依存関係から検出
4. **依存関係・キーワード** - package.json、Gemfile等から抽出
5. **ライセンス** - LICENSE ファイルから検出

#### Git情報

1. **Fork状態** - GitHub/GitLab APIで判定
2. **所有者** - リモートURLから判定（自分/他人）
3. **ブランチ情報** - アクティブブランチと総ブランチ数
4. **最終コミット日時**
5. **未コミット変更の有無**
6. **リモート同期状態** - ahead/behindの状況

#### プロジェクト規模・品質

1. **プロジェクトサイズ** - ファイル数、総行数
2. **README品質** - README.mdの存在と充実度
3. **テストカバレッジ** - テストファイルの存在
4. **CI/CD設定** - GitHub Actions、Jenkins等の設定ファイル

### 2. 高度なフィルタリング・検索機能

#### 標準フィルター

- 上記検知項目によるフィルタリング
- **ユーザー定義タグ** - 手動で設定可能なカスタムタグ
- **お気に入り** - 頻繁に使用するリポジトリのマーク
- **アーカイブ状態** - 非アクティブなプロジェクトの分類

#### 高度な検索

- **ファイル名検索** - README、package.json等の主要ファイル内検索
- **基本パターン検索** - 単純なキーワードマッチング
- **日付範囲検索** - 最終更新日、作成日での絞り込み
- **サイズ範囲検索** - プロジェクトサイズでの絞り込み

#### スマート検索

- **技術スタック検索** - 言語・フレームワークでの類似検索
- **検索履歴** - 過去の検索条件を保存・再利用
- **検索フィルター保存** - よく使うフィルター条件の保存

### 3. リッチなサイドバー表示

#### 基本表示項目

1. **リポジトリ名** - クリックで現在ウィンドウで開く
2. **フォルダ名** - ローカルパス名
3. **主体言語** - アイコン付きで表示
4. **最終更新日時** - 相対時間で表示
5. **Git状態インジケーター** - 変更・同期状態を色分け表示

#### マウスオーバー時の追加アクション

- **新しいウィンドウで開く** ボタン
- **エクスプローラーで開く** ボタン
- **ターミナルで開く** ボタン
- **GitHubで開く** ボタン - リモートリポジトリのWebページを開く
- **クイックプレビュー** - README内容の簡単表示

#### 表示カスタマイズ

- **表示項目の選択** - 各項目の表示/非表示切り替え
- **表示順序** - ドラッグ&ドロップで並び替え
- **表示サイズ** - コンパクト/標準/詳細表示の切り替え
- **グループ表示** - 言語別、プロジェクト種別でのグループ化

### 4. プロジェクト管理機能

#### リポジトリ登録・管理

- **手動スキャン** - 指定フォルダ内のGitリポジトリを手動でスキャン
- **更新ボタン** - サイドバーに更新ボタンを配置し、必要時に情報を更新
- **手動登録** - 任意のフォルダを手動でリストに追加
- **登録解除** - 不要になったフォルダをリストから削除
- **選択的更新** - 特定のリポジトリのみを個別に更新

#### ワークスペース管理

- **ワークスペース保存** - 複数リポジトリを1つのワークスペースとして保存
- **ワークスペース切り替え** - 保存したワークスペース間の高速切り替え
- **関連プロジェクト表示** - 技術スタックが類似するプロジェクトのリスト表示

#### プロジェクト分析

- **アクティビティ履歴** - リポジトリへのアクセス頻度記録
- **使用統計** - 最も使用される言語・フレームワークの統計
- **健康状態チェック** - 長期間更新されていないプロジェクトの警告

### 5. 拡張性・カスタマイズ機能

#### 基本設定

1. **スキャン対象ルートフォルダ** - 複数フォルダの指定
2. **除外設定** - 特定フォルダ・パターンの除外
3. **スキャン深度** - 検索階層の制限
4. **更新時の処理範囲** - 軽量更新（基本情報のみ）/完全更新（全項目）の選択

#### 高度な設定

1. **カスタムアイコン** - 言語・フレームワーク別のアイコン設定
2. **カラーテーマ** - 状態表示色のカスタマイズ
3. **ショートカット** - よく使う操作のキーバインド設定
4. **更新通知** - 手動更新完了時の通知設定

#### API・連携機能

1. **GitHub/GitLab連携** - API経由での詳細情報取得
2. **GitHubページ表示** - リポジトリのWebページを直接開く
3. **エクスポート機能** - リポジトリリストのCSV/JSON出力
4. **インポート機能** - 他のツールからの設定移行

### 6. パフォーマンス・ユーザビリティ

#### パフォーマンス

- **オンデマンド処理** - 必要な時のみ情報を更新
- **段階的スキャン** - 軽量→詳細の段階的な情報取得
- **キャッシュ機能** - 更新済み情報のキャッシュ保存
- **バックグラウンド処理** - UIブロックを避けた非同期処理

#### ユーザビリティ

- **クイックアクセス** - 最近使用したリポジトリへの高速アクセス
- **キーボードナビゲーション** - マウスを使わない操作
- **コンテキストメニュー** - 右クリックでの豊富な操作メニュー
- **ドラッグ&ドロップ** - ファイルエクスプローラーとの連携
- **手動追加UI** - フォルダ選択ダイアログによる簡単登録
- **更新進捗表示** - スキャン中のプログレスバー表示

### 7. セキュリティ・プライバシー

- **認証情報の安全な保存** - VS Code Secretsの活用
- **プライベートリポジトリ対応** - アクセス権限に応じた表示制御
- **ローカル優先** - 可能な限りローカル情報のみで動作
- **データ暗号化** - 設定情報の暗号化保存

## 技術的課題と対応策

### 🚨 技術的に困難・課題がある機能

#### 1. データベース種類の自動検出

**課題**: 設定ファイルから確実にDB種類を判定するのは困難

**対応策**:

- 主要なDB（MySQL、PostgreSQL、MongoDB等）の設定ファイルパターンのみ対応
- 不明な場合は「Unknown」と表示
- 将来的にはユーザーによる手動設定を優先

#### 2. README品質の自動判定

**課題**: 品質の評価基準が主観的で自動化が困難

**対応策**:

- 単純な指標のみ使用（文字数、セクション数、リンク数）
- 「高/中/低」の3段階評価に簡略化
- 完全自動化ではなく参考値として提供

#### 3. 検索機能のパフォーマンス

**課題**: 大量のファイルがある場合、検索が非常に重くなる

**対応策**:

- 検索対象をREADME、package.json等の主要ファイルに限定
- ファイルサイズ制限を設ける（例：1MB以下）
- 検索のタイムアウト設定（10秒）

#### 4. GitHub/GitLab API制限

**課題**: API レート制限により大量リポジトリの処理が困難

**対応策**:

- APIアクセスは必要最小限に限定
- レート制限に達した場合の適切なエラーハンドリング
- ローカル情報を優先し、APIは補助的に使用

### ⚠️ パフォーマンス上の制約

#### 1. プロジェクトサイズ計算

**制約**: 大規模プロジェクト（10万ファイル以上）で処理時間が長くなる

**対応策**:

- ファイル数上限設定（デフォルト：10,000ファイル）
- タイムアウト設定（デフォルト：30秒）
- 段階的処理：基本情報→詳細情報の順

#### 2. 同時処理数の制限

**制約**: 多数のリポジトリを同時処理するとメモリ不足

**対応策**:

- 同時処理数を制限（デフォルト：5リポジトリ）
- 処理キューシステムの実装
- メモリ使用量のモニタリング

### 🔒 セキュリティ上の考慮事項

#### 1. プライベートリポジトリ対応

**課題**: アクセス権限の適切な管理

**対応策**:

- VS Code Secretsを使用したトークン管理
- 権限エラー時の適切な表示
- ローカルファイルアクセスのみでも基本機能は動作

#### 2. APIトークンの安全性

**対応策**:

- トークンの暗号化保存
- 必要最小限の権限のみ要求
- トークンの有効期限チェック

### 📋 機能の優先度調整

#### Phase 4に移行する機能

- **依存関係の可視化** → **関連プロジェクト分析**に簡略化
- **全文検索・正規表現検索** → **基本的なファイル名検索**に簡略化
- **類似プロジェクト検索** → **技術スタック検索**に簡略化

## 実装優先度

### Phase 1: 基本機能（MVP）

- 基本的なリポジトリスキャン・表示（手動更新）
- 主体言語の検知
- 基本的なフィルタリング
- シンプルなサイドバー表示
- 更新ボタンの実装

### Phase 2: 検索・フィルタ強化

- 高度な検索機能
- Git情報の表示
- お気に入り・タグ機能
- 表示カスタマイズ

### Phase 3: 管理・分析機能

- ワークスペース管理
- プロジェクト分析
- 外部API連携
- パフォーマンス最適化（段階的スキャン）

### Phase 4: 高度な機能

- 関連プロジェクト分析の高度化
- 高度なセキュリティ機能
- エンタープライズ向け機能
- 高度なGitHub/GitLab API活用

## 技術仕様

### 対応環境

- **VS Code**: 1.80.0以上
- **Node.js**: 18.0以上
- **OS**: Windows、macOS、Linux

### 使用技術

- **フレームワーク**: TypeScript、VS Code Extension API
- **ビルドツール**: webpack、esbuild
- **テスト**: Jest、VS Code Test API
- **パッケージマネージャー**: npm/yarn

### データ保存

- **設定**: VS Code Settings API
- **キャッシュ**: ローカルファイルシステム
- **認証情報**: VS Code Secrets API

## ライセンス・配布

- **ライセンス**: MIT License
- **配布方法**: VS Code Marketplace
- **オープンソース**: GitHub公開リポジトリ

## 関連ドキュメント

- [詳細設計書](./detailed-design.md) - システム構成、データモデル、API設計等の技術仕様
- [画面設計書](./ui-design.md) - UI/UX設計、画面レイアウト、アクセシビリティ対応
